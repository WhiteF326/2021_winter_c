<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css" type="text/css">
</head>
<body>
<h1>登下校タイムアタック！</h1>
<h4>～設定～</h4>
    <div>
      　自宅住所（番地まで） <input type="text" id="my-home" /><button
        id="my-home-btn"
      >
        送信
      </button>
    </div>
    <script type="module">
      import { fetchJSON } from "https://js.sabae.cc/fetchJSON.js";
      document
        .getElementById("my-home-btn")
        .addEventListener("click", async function () {
          const myHome = document.getElementById("my-home").value;

          fetchJSON("/api/geocoder", {
            address: myHome,
          }).then((res) => {
            if (res == null) {
              window.alert("入力された住所は見つかりませんでした。");
            } else {
              const value = res[0];
              localStorage.setItem("start", JSON.stringify(value));
            }
          });
        });
    </script>
    <div>
      　学校住所（番地まで） <input type="text" id="school" /><button
        id="school-btn"
      >
        送信
      </button>
    </div>
<h4>登校手段設定</h4>
<div>
    <input type="checkbox" id="walk" name="horns"> 徒歩
    <input type="checkbox" id="vehicle"> 公共交通機関
    <input type="checkbox" id="bicycle"> 自転車
    <input type="checkbox" id="car"> 自家用車
</div>

<div>
    <button onclick="location.href='/playing.html'">スタート！</button>
</div>
<script>
    window.addEventListener("load", function(e){
        const userId = generateUuid();
        localStorage.setItem("userId", userId)
    })
    function generateUuid() {
    // https://github.com/GoogleChrome/chrome-platform-analytics/blob/master/src/internal/identifier.js
    // const FORMAT: string = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";
    let chars = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("");
    for (let i = 0, len = chars.length; i < len; i++) {
        switch (chars[i]) {
            case "x":
                chars[i] = Math.floor(Math.random() * 16).toString(16);
                break;
            case "y":
                chars[i] = (Math.floor(Math.random() * 4) + 8).toString(16);
                break;
        }
    }
    return chars.join("");
}
</script>
<script type="module">
    import { fetchJSON } from "https://js.sabae.cc/fetchJSON.js";
    document
      .getElementById("school-btn")
      .addEventListener("click", async function () {
        const myHome = document.getElementById("school").value;

        fetchJSON("/api/geocoder", {
          address: myHome,
        }).then((res) => {
          if (res == null) {
            window, alert("入力された住所は見つかりませんでした。");
          } else {
            const value = res[0];
            localStorage.setItem("goal", JSON.stringify(value));
          }
        });
      });
  </script>
</body>
</html>
